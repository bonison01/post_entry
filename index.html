<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Data Extractor</title>
    <link rel="stylesheet" href="index.css">
    <script type="importmap">
      {
        "imports": {
          "@google/genai": "https://esm.sh/@google/genai@^0.14.0"
        }
      }
    </script>
    <script type="module" src="index.tsx"></script>
    <script src="https://accounts.google.com/gsi/client" async></script>
    <script src="https://apis.google.com/js/api.js" async></script>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <main>
        <h1>ðŸ“„ Document Data Extractor</h1>
        <p>Upload a document image to automatically extract structured data.</p>
        <div class="controls">
            <div class="file-uploader">
                <label for="file-upload" id="file-label">
                    <span>Click to upload or drag & drop</span>
                </label>
                <input type="file" id="file-upload" accept="image/*">
            </div>
            <button id="extract-button" disabled>Extract Data</button>

            <div class="g-sheet-controls">
                <h3>Export Options</h3>
                <button id="connect-g-sheet-button">Connect to Google Sheets</button>
                <p id="g-sheet-status">Status: Not Connected</p>
                <button id="export-button" disabled>Export to Sheet</button>
                <button id="download-csv-button" disabled>Download CSV</button>
                <button id="copy-button" disabled>Copy Data</button>
                <div id="export-result" class="hidden"></div>
            </div>
        </div>
        <div class="output">
            <div class="preview-container">
                <img id="image-preview" src="#" alt="Image preview" class="hidden"/>
            </div>
            <div id="loader" class="hidden">
                <div class="spinner"></div>
                <div class="progress-bar-container">
                    <div id="progress-bar"></div>
                </div>
                <p id="loader-percentage">0%</p>
                <p id="loader-message">Analyzing document... this may take a moment.</p>
            </div>
            <p id="error-message" class="hidden"></p>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Serial No.</th>
                            <th>Article Number</th>
                            <th>Product Type</th>
                            <th>Weight (gms)</th>
                            <th>Sender Name</th>
                            <th>Receiver Name</th>
                            <th>Base Tariff (incl. VAS)</th>
                            <th>Remarks</th>
                            <th>Created By</th>
                            <th>Created On</th>
                            <th>Bulk Reference</th>
                        </tr>
                    </thead>
                    <tbody id="results-body">
                    </tbody>
                </table>
            </div>
        </div>
    </main>
<script type="module" src="/index.tsx"></script>
</body>
</html>